%% LDA AND QDA CLASSIFIERS FOR BCI DATA
% DESCRIPTION HERE...

%% ABOUT
% * Author: Iraquitan Cordeiro Filho
% * Company: Institudo Tecnologico Vale - Desenvolvimento Sustentavel

%% PRELIMINARIES
% Clear our workspace
clear all
clc

% Close all figures
close all

% * IMPORTING THE DATA
%
load('Ferreira BV_Edit_F2');
%% PRE-PROCESS DATA
electrodes_g1 = [3,4,11,12];
electrodes_g2 = [6,7,8,9];

features_vec = [26,52,77,103]; % [0.2015s 0.4031s 0.5968s 0.7984s]
features_vec_L = [32,65]; % [0.2015s 0.4031s 0.5968s 0.7984s]

% separate right and left trials
grp1 = grp2idx(veckRefs)==1; % Group 2 (Left)
grp2 = grp2idx(veckRefs)==2; % Group 4 (Right)
%% For 1s Epochs
%X1L = zeros(size(epochS{1}(:,:,grp1),3)*3,size(electrodes_g1,2)*size(features_vec,2));
%X1R = zeros(size(epochS{1}(:,:,grp2),3)*3,size(electrodes_g1,2)*size(features_vec,2));
X1S = cell(1,size(epochS,2));
X1All = [];
X1Left = [];
X1Right = [];
for i=1:3
    %{
    for j=1:size(epochS{i},3)
        temp1 = epochS{i}(electrodes_g1,features_vec,j);
        temp2 = reshape(temp1(:,:,1)',1,[]); % Reshape electrodes to one line E1,E1,E2,...
    end
    %}
    temp = org_bci_data(epochS{i}(electrodes_g1,features_vec,:));
    temp1 = org_bci_data(epochS{i}(electrodes_g1,features_vec,grp1));
    temp2 = org_bci_data(epochS{i}(electrodes_g1,features_vec,grp2));
    X1All = vertcat(X1All,temp);
    X1Left = vertcat(X1Left,temp1);
    X1Right = vertcat(X1Right,temp2);
    clear temp temp1 temp2
end
X1S = {X1All,X1Left,X1Right};
clear X1All X1Left X1Right
X1S_Labels = go_nogo_labels(X1S);
%% For 0,5s Epochs
X1L = cell(1,size(epochL,2));
X1All = [];
X1Left = [];
X1Right = [];
for i=1:6
    %{
    temp1 = epochL(electrodes_g1,features_vec,i);
    temp2 = reshape(temp1(:,:,1)',1,[]); % Reshape electrodes to one line E1,E1,E2,...
    %}
    temp = org_bci_data(epochL{i}(electrodes_g1,features_vec,:));
    temp1 = org_bci_data(epochL{i}(electrodes_g1,features_vec,grp1));
    temp2 = org_bci_data(epochL{i}(electrodes_g1,features_vec,grp2));
    X1All = vertcat(X1All,temp);
    X1Left = vertcat(X1Left,temp1);
    X1Right = vertcat(X1Right,temp2);
    clear temp temp1 temp2
end
X1L = {X1All,X1Left,X1Right};
clear X1All X1Left X1Right
X1L_Labels = go_nogo_labels(X1L);